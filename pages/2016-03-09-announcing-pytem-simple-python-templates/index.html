<!DOCTYPE html>
<html>
<head>
<!-- page.tm
  Left sidebar area with links to posts
  Right main area for the page content.

  Can be used for any page where we want the default sidebar
  index in the sidebar.
-->
<!-- This is head_incl.tm, for things like meta tags, favicon, CSS links, script tags, etc. -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Announcing PyTem: Simple Python Templates</title>

<script type="text/javascript">
  // Do something interesting and useful here.
</script>

<!-- favicon -->
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />

<!--
  ***
  ***  CSS Stylesheets
  ***
-->
<link rel="stylesheet" href="/resources/css/normalize.css"/>
<link rel="stylesheet" href="/resources/css/main.css"/>

</head>

<body>
    <script>
var page = {"page_type": "post", "title": "Announcing PyTem: Simple Python Templates", "template": "page.tm", "summary": "PyTem is an implementation of a \"Python-Server-Pages\"-like template\nengine for Python 3+.", "format": "md", "tags": ["tech"], "date": ["2016", "03", "09"], "page_id": "2016-03-09-announcing-pytem-simple-python-templates", "author": "Steve Beisner"};
</script>

<div class="row-nowrap">
  <div style="flex: 0 0 3%"></div>
  <div id="banner" style="flex: 0 1 100%">
    <!-- image goes here -->
  </div>
  <div style="flex: 0 0 3%"></div>
</div>

<div class="row-nowrap" style="padding-top: 10px; padding-bottom: 10px;">
  <div style="flex: 0 0 3%"></div>
  <h3 class="item-fixed">
    Steve Beisner's Blog
  </h3>
  <div style="flex: 0 1 100%"></div>
  <h3 class="item-fixed">
    Writing, Technology, Places, Life

  </h3>
  <div style="flex: 0 0 3%"></div>
</div>


<nav>
  <a href="/pages/home/">Home</a>
  <a href="/pages/about/">About</a>
  <a href="/pages/tagged-by/#new orleans">New Orleans Posts</a>
  <a href="/pages/tagged-by/#tech">Tech Posts</a>
</nav>  


<script>
    var img_by_tag = {
      '*no*tag*':       ['foggy_forest.jpg', 'riverFogPano.jpg', 
                         'fountainpen.jpg'],
      'life':           ['foggy_forest.jpg', 'riverFogPano.jpg'],
      'new orleans':    ['Esplanade-pano.jpg', 'MississippiNewOrleans.jpg',
                         'TreeOfLifeAudubonParkPano2.jpg'],
      'santa barbara':  ['cropped-SantaBarbaraPano.jpg'],
      'tech':           ['computerMuseumPano.jpg','Univac9400pano.jpg'],
      'writing':        ['typewritertype.jpg','fountainpen.jpg']
    }
    var pageTag = '*no*tag*';
    console.log('page.tags=' + JSON.stringify(page.tags));
    if( page.tags.length) {
      pageTag = page.tags[ Math.floor(page.tags.length*Math.random()) ];
      if( ! (pageTag in img_by_tag) ) {
        pageTag = '*no*tag*';
      }
    }
    console.log('pageTag=' + JSON.stringify(pageTag));
    var imgs = img_by_tag[ pageTag];
    console.log('imgs=' + JSON.stringify(imgs))
    var img = imgs[ Math.floor(imgs.length*Math.random()) ];
    console.log('img=' + JSON.stringify(img));
    document.getElementById('banner').innerHTML = 
      '<img src="/resources/images/' + img + '" style="width:100%" />';
</script>

    <h1 id="page_title" class="center-block">Announcing PyTem: Simple Python Templates</h1>

      <h3 class="center-block">
        by Steve Beisner
      </h3>
 
      <h3 class="center-block">
        tags: tech
      </h3>


    <div class="row-nowrap">                    <!-- ROW -->
      <div class="item-sidebar">
                  <h4>Recent Posts</h4>
              <h5>
                <a href="/pages/2016-03-09-announcing-pytem-simple-python-templates/">Announcing PyTem: Simple Python Templates</a>
                <br/>
                <span style="font-size: 75%">
                2016/03/09
                </span>
              </h5>
              <h5>
                <a href="/pages/2015-11-11-all-saints-day-at-the-maple-leaf-bar/">All Saints Day at the Maple Leaf Bar</a>
                <br/>
                <span style="font-size: 75%">
                2015/11/11
                </span>
              </h5>
              <h5>
                <a href="/pages/2015-10-30-the-new-old-new-orleans-los-po-boy-citos/">The New Old New Orleans: Los Po-Boy Citos</a>
                <br/>
                <span style="font-size: 75%">
                2015/10/30
                </span>
              </h5>
              <h5>
                <a href="/pages/2015-07-03-sounds-of-new-orleans-from-anywhere/">Sounds Of New Orleans From Anywhere</a>
                <br/>
                <span style="font-size: 75%">
                2015/07/03
                </span>
              </h5>


          <h4>Pages By Tags</h4>
            <h5 style="display:inline">
              <a href="/pages/tagged-by/#life">
              life&nbsp;(4)&nbsp;&nbsp;&nbsp;
              </a>
            </h5>
            <h5 style="display:inline">
              <a href="/pages/tagged-by/#new orleans">
              new&nbsp;orleans&nbsp;(7)&nbsp;&nbsp;&nbsp;
              </a>
            </h5>
            <h5 style="display:inline">
              <a href="/pages/tagged-by/#tech">
              tech&nbsp;(3)&nbsp;&nbsp;&nbsp;
              </a>
            </h5>
            <h5 style="display:inline">
              <a href="/pages/tagged-by/#writing">
              writing&nbsp;(3)&nbsp;&nbsp;&nbsp;
              </a>
            </h5>


          <h4>Related or Affiliated Sites:</h4>
          <h5>
            <a href="http://inkbytepress.com">
              Ink Byte Press
            </a>
          </h5>
          <h5>
            <a href="http://melindapalacio.com">
              Melinda Palacio's Author Web Site
            </a>
          </h5>
          <h5>
            <a href="http://LunaReview.com">
              The Luna Review
            </a>
          </h5>


          <h4>Steve Beisner:</h4>
          <p>Steve Beisner can usually be found in New Orleans LA or Santa
          Barbara CA, writing software, poetry, or fiction.  You can contact
          him by any of the methods described on the
          <a href="/pages/about">About</a> page.
          </p>
      </div>

      <div class="item-content">
          <h3>Intro: What is PyTem?</h3>
<p>PyTem is an implementation of a "Python-Server-Pages"-like template engine for Python 3+.
PyTem is,</p>
<ul>
<li>small -- a single python file.</li>
<li>simple  -- you can learn the syntax of templates and/or the PyTem API in just a few minutes.</li>
<li>hackable -- readable source code, so feel free to adapt it to your own python project.</li>
</ul>
<p>PyTem's current status is "Alpha", but it is being used for real work on a daily basis.</p>
<p>PyTem can run as a standalone program from the command line, or can be imported into another Python 3 program and used via a small/simple API.</p>
<h3>Installation</h3>
<pre><code>pip install PyTem
</code></pre>
<h3>Syntax of PyTem Templates</h3>
<p>A PyTem template is a text file (.txt, .html, .markdown, etc.) containing, in addition the
"normal" text appropriate to the file type, python statements and python expressions.</p>
<h3>An Example of a PyTem Template</h3>
<p>Here is a file named "pytem_demo4.tm", showing python statement lines and lines containing
pure text and python expressions.</p>
<pre><code>    This is a PyTem Template it will output these 2 
    initial lines, a greeting, and 4 numbered lines.
    % count = 4
    &lt;%greeting%&gt; to you, &lt;% name.upper() %&gt;. OK?
    %    for ix in range(count):
    This is line #&lt;% ix %&gt;.
    %    end
</code></pre>
<p>The third, fifth, and seventh lines of the above template are python statements,
as indicated by the '%' at the beginning of the line.
Indentation is not significant:  PyTem will correct the indentation of the python
statements during compilation of the template into pure python.
PyTem recognizes a change in required indentation by</p>
<ol>
<li>a line whose last non-whitespace character is ':', indicating the
start of a compound statement like "<code>% for</code>", "<code>% if</code>", "<code>% else</code>", etc.</li>
<li>a line like "<code>%  end</code>", indicating the close of a compound statement.</li>
</ol>
<p>Anything written to Standard Output by a template's python lines will be
inserted into the template expansion.</p>
<p>The lines not beginning with "%" are text lines.  They will be output "as is", except
that python expressions, like "<code>&lt;% ix %&gt;</code>" will be replaced by the value of the
enclosed python expression.</p>
<p>Here is a python program that will write the expanded template 
to standard output,</p>
<pre><code>from pytem import PyTem
pt = PyTem()
s = pt.expandFile( 'pytem_demo4.tm', 
                   {'greeting':'Hello', 'name':'George'})
print(s)
</code></pre>
<h3>Including other templates</h3>
<p>Inside a template file, another template file can be included, interpreted in the same
environment, using</p>
<pre><code>    &lt;% include_template('another.tm') %&gt;
</code></pre>
<p><strong>NOTE:</strong> There is nothing special about this... it's just another python expression,
calling the function, "include_template".</p>
<h3>PyTem API -- General Comments</h3>
<p>The API consists of three entry points: the constructor, <code>PyTem</code>, and two methods, <code>expandString</code>
and <code>expandFile</code>.  Usage means calling the constructor to obtain a PyTem instance, followed by
one or more calls to <code>expandString</code> or <code>expandFile</code>, each returning a string, and possibly modifying the evaluation environment for future calls to <code>expandString</code> or <code>expandFile</code> using
the same PyTem instance.</p>
<p>Evaluation of templates involves an <em>environment</em> that provides variable bindings for the
evaluation of embedded python statements and expressions.  An initial environment may
optionally be specified when the PyTem constructor is called.  Subsequent calls to <code>expandString</code> and <code>expandFile</code> may update the environment, as may changes to variables make by python code 
inside the templates.</p>
<p>The environment is maintained inside the PyTem instance, so changes
made during an expansion will be visible to later expansions.  To start with a clean
environment, create another PyTem instance by calling the constructor again.</p>
<p>Compiled template files (but not template strings) are cached, so that they are compiled
once even if used multiple time with the same PyTem instance.</p>
<p>For debugging: if the pyfile option is true, then the compiled template (i.e. pure python)
named "infile" is saved in file, "infile.py", for debugging.</p>
<h3>PyTem API -- The Constructor</h3>
<p>A instance of class, <strong>PyTem</strong>, is constructed and used for all subsequent operations.
A call to the constructor has the following signature:</p>
<pre><code>  pytem = PyTem( search_path = ['.'],  
                 debug = 0,  
                 pyfile = False, 
                 env = {})
</code></pre>
<p>The constructor's optional keyword arguments are:</p>
<ul>
<li><p><code>search_path</code> defaults to ['.'], a list of directories in which to search for named templates.
On the command line <code>search_path</code> is set with the option, "-s" or "--search_path".</p>
</li>
<li><p><code>debug</code> defaults to 0x0000, provides an optional mask of bits to control debug output.
On the command line <code>debug</code> is set with the option, "-d" or "--debug".</p>
</li>
<li><p><code>pyfile</code> defaults to False. If True, a file with '.py' appended to the name of the input
template file will be created, containing the python code for the "compiled" input template file.
On the command line <code>pyfile</code> is set with the option, "-p".</p>
</li>
<li><p><code>env</code>, the initial evaluation environment, defaults to the empty dictionary, <code>{}</code>.
The <code>env</code> option can not be set on the command line.</p>
</li>
</ul>
<h3>PyTem API -- Method <code>expandString</code></h3>
<p>The <code>expandString</code> method optionally updates the environment with a list of dictionaries and
key/value pairs, then expands the <code>template_string</code>.  The <code>infilename</code> serves as an identifier
of the string in error messages.</p>
<pre><code>    expandString(self,  template_string,  
                        infilename(string),  
                        *kv_dicts,  **kv_vars )
</code></pre>
<p>The <code>expandString</code> method return the (string) expansion of the <code>template_string</code>.</p>
<h3>PyTem API -- Method <code>expandFile</code></h3>
<p>The <code>expandFile</code> method optionally updates the environment with a list of dictionaries and
key/value pairs, then expands the file named by <code>infilename</code>.  The file is searched for in
the directories specified in the <code>search_path</code> list parameter to the PyTem constructor.</p>
<pre><code>    expandFile(self,   infilename,  
                       *kv_dicts,   **kv_vars)
</code></pre>
<p>The <code>expandFile</code> method return the (string) expansion of the file named by <code>infilename</code>.</p>
<h3>Standalone (CLI) Program</h3>
<p>The installed module, <code>pytem.py</code>, can be run from the command line.  An example:</p>
<pre><code>    python ?wherever?/pytem.py  -o myfile.out  myfile.tm
</code></pre>
<p>You might want to create a batch file (shell script) to do this, since <code>pytem.py</code> is
probably located deep in your site-packages directory.</p>
<pre><code>Usage:  python pytem.py [options] infile, ...
Options
  (-h | --help          This help message.
  (-d | --debug)        debug mask bits
  (-s | --search_path)  path1,path2,...
                        0x4000  Show python source
                                for compiled templates.
                        0x0100  Minor messages
  -p                    If true, output the compiled (python) template
                        named "infile" to "infile.py" for debugging.
  (-o | --out)          Out file name. Defaults to '&lt;stdout&gt;' if
                        not specified.
Expands infiles in order. Keeping environment from one to the next
If no infiles specified, use &lt;stdin&gt;.
</code></pre>

      </div>
    </div>


    <div class="row-nowrap">                    <!-- ROW -->
      <div class="item-sidebar">
      </div>
      
      <div class="item-content">
          <div class="row-nowrap" style="justify-content: space-around">
    <h5 class="item-fixed">Steve Beisner's Blog</h5>
    <h5 class="item-fixed">Comments: beisner@alum.mit.edu</h5>
    <h5 class="item-fixed">Copyright 2016 by Steve Beisner</h5>
</div>
      </div>      
    </div>

</body>
</html>
